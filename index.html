<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>D-Day Manager</title>

<style>

  @font-face {
    font-family: 'MitmiFont';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2402_1@1.0/Ownglyph_meetme-Rg.woff2') format('woff2');
    font-weight: normal;
    font-display: swap;
}

@font-face {
    font-family: 'OngleipKimkonghae';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408@1.0/Ownglyph_kimkonghae.woff2') format('woff2');
    font-weight: normal;
    font-display: swap;
}

  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:#f4f6fb;font-family:'OngleipKimkonghae', Arial, Helvetica, sans-serif;display:flex;justify-content:center;padding:40px;}
  .wrap{position: relative; max-width:600px;width:100%;background:#fff;padding:25px;border-radius:18px;box-shadow:0 10px 20px rgba(0,0,0,0.1);}
  h1{font-size:30px;margin-bottom:20px;text-align:center; font-family: 'MitmiFont'; letter-spacing: 1.6px;}

  .add_box{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;}
  .add_box input{padding:10px;border:1px solid #ccc;border-radius:6px;flex:1;min-width:0;}
  .add_box input[type="date"]{min-width:150px;}
  .add_box button{padding:10px 18px;border-radius:6px;border:0;background:#000;color:#fff;cursor:pointer;}

  ul{margin-top:10px;}
  li{display:flex;justify-content:space-between;align-items:center;
    padding:12px;border-radius:10px;border:1px solid #ddd;
    margin-bottom:10px;background:#fafafa;}

  .info strong{font-size:16px;display:block;}
  .info span{color:#777;font-size:14px;}

  .dday{font-size:20px;font-weight:bold;}

  button.delete{background:#ff4b4b;color:#fff;border:0; padding:4px 6px; font-size: 10px; border-radius:6px;cursor:pointer;}
  
  button.all_delete{position: absolute; right: 30px; top: 20px; width:60px; height: 30px; background:#ff4b4b; font-size: 11px; color:#fff; border:0; border-radius:6px;}

  @media(max-width:480px){
    body{padding:15px;}
    .wrap{padding:18px;}
    .add_box{flex-direction:column;}
    .add_box input{width:100%;}
  }
</style>
</head>

<body>
<div class="wrap">
  <h1>D-DAY LIST</h1>

  <div class="add_box">
    <input type="text" id="title" placeholder="ì´ë²¤íŠ¸ ì´ë¦„ ì…ë ¥í•˜ê¸°!">
    <input type="date" id="date">
    <button onclick="add()">ì¶”ê°€</button>
  </div>

  <ul id="list"></ul>

  <button type="button" class="all_delete" onclick="allDel()">ì „ì²´ ì‚­ì œ</button>
</div>

<script>
  //date input í´ë¦­ì‹œ ë‹¬ë ¥ì˜¤í”ˆ
  const dateInput = document.getElementById("date");
  dateInput.addEventListener("click", () => {
    dateInput.showPicker();
  });

  //í™”ë©´ì— ë¦¬ìŠ¤íŠ¸ê°€ ë Œë”ë§ ë  ul ìš”ì†Œë¥¼ ê°€ì ¸ì™€ ddayList ë³€ìˆ˜ì— localStorageì—ì„œ ë¶ˆëŸ¬ì˜¨ d-day ë°°ì—´ì„ ì €ì¥.ì—†ìœ¼ë©´ [] ë¹ˆë°°ì—´ë¡œ ì´ˆê¸°í™”
  const list = document.getElementById("list");
  let ddayList = JSON.parse(localStorage.getItem("ddays")) || [];

  //localStorageì— ì €ì¥ í•¨ìˆ˜
  function save(){
    localStorage.setItem("ddays", JSON.stringify(ddayList));
  }

  //D-day ê³„ì‚° í•¨ìˆ˜
  function calc(target){
    const today = new Date();
    const day = new Date(target);

    today.setHours(0,0,0,0);
    day.setHours(0,0,0,0);

    const diff = day - today;
    const days = Math.floor(diff / (1000*60*60*24));

    if(days > 0) return `D-${days}`;
    if(days === 0) return "D-DAY ğŸ‰";
    return `D+${Math.abs(days)}`;
  }

  //í™”ë©´ ë Œë”ë§ í•¨ìˆ˜
  function render(){
    list.innerHTML = "";
    ddayList.forEach((item,index)=>{
      const li = document.createElement("li");
      //li í´ë¦­ì‹œ ìˆ˜ì • í•¨ìˆ˜ í˜¸ì¶œ
      li.onclick = () => ddayEdit(index);

      li.innerHTML = `
        <div class="info">
          <strong>${item.title}</strong>
          <span>${item.date}</span>
        </div>

        <div class="dday">${calc(item.date)}</div>

        <button class="delete" onclick="remove(${index})">ì‚­ì œ</button>
      `;

      list.appendChild(li);
    });
  }

  //d-day ì¶”ê°€ í•¨ìˆ˜
  function add(){
    const title = document.getElementById("title");
    const date = document.getElementById("date");

    if(!title.value.trim()){
      alert("ì´ë²¤íŠ¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”");
      return;
    }

    if(!date.value){
      alert("ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”");
      return;
    }

    ddayList.push({
      title: title.value,
      date: date.value
    });

    title.value = "";
    date.value = "";

    //ì¶”ê°€í•¨ìˆ˜ì—ì„œ ì €ì¥,ë Œë”ë§ í•¨ìˆ˜ í˜¸ì¶œ
    save();
    render();
  }

  //ì „ì²´ì‚­ì œ í•¨ìˆ˜
  function allDel(){
    //confirmì—ì„œ ì·¨ì†Œ ì„ íƒì‹œ í•¨ìˆ˜ì¢…ë£Œ
    if(!confirm('ë””ë°ì´ë¥¼ ì „ì²´ ì‚­ì œí• ê¹Œìš”?')) return;

    //ë¹ˆë°°ì—´ë¡œ ì´ˆê¸°í™”
    ddayList = [];

    //ì „ì²´ì‚­ì œí•¨ìˆ˜ì—ì„œ ì €ì¥,ë Œë”ë§ í•¨ìˆ˜ í˜¸ì¶œ
    save();
    render();

  };

  //d-day ì‚­ì œ í•¨ìˆ˜
  function remove(index){
    //confirm ì—ì„œ ì·¨ì†Œ ì„ íƒì‹œ í•¨ìˆ˜ì¢…ë£Œ
    if(!confirm('ë””ë°ì´ë¥¼ ì‚­ì œí• ê¹Œìš”?')) return;

    ddayList.splice(index,1);

    //ì‚­ì œí•¨ìˆ˜ì—ì„œ ì €ì¥,ë Œë”ë§ í•¨ìˆ˜ í˜¸ì¶œ
    save();
    render();
  }

  //d-day ë¦¬ìŠ¤íŠ¸ li í´ë¦­ì‹œ í•´ë‹¹ ë¦¬ìŠ¤íŠ¸ ë‚´ìš©ì´ inputì— í‘œì‹œë˜ê³  ìˆ˜ì • í•¨ìˆ˜
  function ddayEdit(index){
    const title = document.getElementById("title");
    const date = document.getElementById("date");

    title.value = ddayList[index].title;
    date.value = ddayList[index].date;

    //ë¦¬ìŠ¤íŠ¸ì—ì„œ í•´ë‹¹ í•­ëª© ì‚­ì œ
    ddayList.splice(index,1);

    //ìˆ˜ì •í•¨ìˆ˜ì—ì„œ ì €ì¥,ë Œë”ë§ í•¨ìˆ˜ í˜¸ì¶œ
    save();
    render();
  };

  //ì´ˆê¸° ë Œë”ë§
  render();
</script>

</body>
</html>
